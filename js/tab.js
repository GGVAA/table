const tableData = [
  {
    logo: "../img/1Tab.png",
    id: 1,
    logoName: "Figma",
    link: "https://www.figma.com/",
    cardType: "Visa",
    cardNumber: "*****2458",
    name: "Itai Bracha",
    date1: "May 5,2022",
    date1Compare: "2022/05/05",
    date2: "Aug 2,2022",
    date2Compare: "2022/08/02",
    status: "Pending",
    email: "Itai Bracha31@gmail.com",
    transaction: 83.22,
    dot: "...",
  },
  {
    logo: "../img/2Tab.png",
    logoName: "Abode XD",
    id: 2,
    link: "https://www.adobe.com/",
    cardType: "Visa",
    cardNumber: "*****4268",
    name: "Anna",
    date1: "May 5,2022",
    date1Compare: "2022/05/05",
    date2: "Aug 10,2022",
    date2Compare: "2022/08/10",
    status: "Done",
    email: "Itai Bracha31@gmail.com",
    transaction: 78.99,
    dot: "...",
  },

  {
    logo: "../img/3Tab.png",
    logoName: "Mailchimp",
    id: 3,
    link: "https://mailchimp.com/",
    cardType: "Visa",
    cardNumber: "*****9456",
    name: "Kate",
    date1: "May 5,2022",
    date1Compare: "2022/05/05",
    date2: "Aug 2,2022",
    date2Compare: "2022/08/02",
    status: "Done",
    email: "Itai Bracha31@gmail.com",
    transaction: 123.82,
    dot: "...",
  },

  {
    logo: "../img/4Tab.png",
    logoName: "WIX",
    id: 4,
    link: "https://www.wix.com/",
    status: "Pending",
    cardType: "Visa",
    cardNumber: "*****1025",
    name: "Bob",
    date1: "May 5,2022",
    date1Compare: "2022/05/05",
    date2: "Aug 10,2022",
    date2Compare: "2022/08/10",
    email: "Itai Bracha31@gmail.com",
    transaction: 1783.22,
    dot: "...",
  },

  {
    logo: "../img/4Tab.png",
    logoName: "WIX",
    id: 4,
    link: "https://www.wix.com/",
    status: "Pending",
    cardType: "Visa",
    cardNumber: "*****1025",
    name: "Bob",
    date1: "May 5,2022",
    date1Compare: "2022/05/05",
    date2: "Aug 2,2022",
    date2Compare: "2022/08/02",
    email: "Itai Bracha31@gmail.com",
    transaction: 133.22,
    dot: "...",
  },

  {
    logo: "../img/5Tab.png",
    logoName: "Youtube",
    id: 6,
    link: "https://www.youtube.com/",
    cardType: "Visa",
    cardNumber: "*****6892",
    name: "Pavlo",
    date1: "May 5,2022",
    date1Compare: "2022/05/05",
    date2: "Aug 10,2022",
    date2Compare: "2022/08/10",
    status: "Done",
    email: "Itai Bracha31@gmail.com",
    transaction: 93.22,
    dot: "...",
  },

  {
    logo: "../img/5Tab.png",
    logoName: "Youtube",
    id: 7,
    link: "https://www.youtube.com/",
    cardType: "Visa",
    cardNumber: "*****8963",
    name: "Sofi",
    date1: "May 5,2022",
    date1Compare: "2022/05/05",
    date2: "Aug 2,2022",
    date2Compare: "2022/08/02",
    status: "Done",
    email: "Itai Bracha31@gmail.com",
    transaction: 783.5,
    dot: "...",
  },
  {
    logo: "../img/1Tab.png",
    id: 8,
    logoName: "Figma",
    link: "https://www.figma.com/",
    cardType: "Visa",
    cardNumber: "*****1468",
    name: "Bob",
    date1: "May 5,2022",
    date1Compare: "2022/05/05",
    date2: "Aug 10,2022",
    date2Compare: "2022/08/10",
    status: "Done",
    email: "Itai Bracha31@gmail.com",
    transaction: 53.22,
    dot: "...",
  },
  {
    logo: "../img/2Tab.png",
    logoName: "Abode XD",
    id: 9,
    link: "https://www.adobe.com/",
    cardType: "Visa",
    cardNumber: "*****2122",
    name: "Bob",
    date1: "May 5,2022",
    date1Compare: "2022/05/05",
    date2: "Aug 2,2022",
    date2Compare: "2022/08/02",
    status: "Done",
    email: "Itai Bracha31@gmail.com",
    transaction: 589.22,
    dot: "...",
  },
  {
    logo: "../img/3Tab.png",
    logoName: "Mailchimp",
    id: 10,
    link: "https://mailchimp.com/",
    cardType: "Visa",
    cardNumber: "*****9632",
    name: "Kate",
    date1: "May 5,2022",
    date1Compare: "2022/05/05",
    date2: "Aug 10,2022",
    date2Compare: "2022/08/10",
    status: "Done",
    email: "Itai Bracha31@gmail.com",
    transaction: 103.22,
    dot: "...",
  },

  {
    logo: "../img/4Tab.png",
    logoName: "WIX",
    id: 11,
    link: "https://www.wix.com/",
    status: "Pending",
    cardType: "Visa",
    cardNumber: "*****9876",
    name: "Bob",
    date1: "Jan 18,2022",
    date1Compare: "2022/05/05",
    date2: "Aug 2,2022",
    date2Compare: "2022/08/02",
    email: "Itai Bracha31@gmail.com",
    transaction: 573.22,
    dot: "...",
  },
  {
    logo: "../img/1Tab.png",
    id: 12,
    logoName: "Figma",
    link: "https://www.figma.com/",
    cardType: "Visa",
    cardNumber: "*****2458",
    name: "Itai Bracha",
    date1: "Jan 5,2022",
    date1Compare: "2022/05/05",
    date2: "Aug 10,2022",
    date2Compare: "2022/08/10",
    status: "Pending",
    email: "Itai Bracha31@gmail.com",
    transaction: 193.22,
    dot: "...",
  },
  {
    logo: "../img/2Tab.png",
    logoName: "Abode XD",
    id: 13,
    link: "https://www.adobe.com/",
    cardType: "Visa",
    cardNumber: "*****4268",
    name: "Anna",
    date1: "May 5,2022",
    date1Compare: "2022/05/05",
    date2: "Aug 2,2022",
    date2Compare: "2022/08/02",
    status: "Done",
    email: "Itai Bracha31@gmail.com",
    transaction: 883.22,
    dot: "...",
  },

  {
    logo: "../img/3Tab.png",
    logoName: "Mailchimp",
    id: 14,
    link: "https://mailchimp.com/",
    cardType: "Visa",
    cardNumber: "*****9456",
    name: "Kate",
    date1: "Jan 5,2022",
    date1Compare: "2022/01/05",
    date2: "Aug 10,2022",
    date2Compare: "2022/08/10",
    status: "Done",
    email: "Itai Bracha31@gmail.com",
    transaction: 783.22,
    dot: "...",
  },

  {
    logo: "../img/4Tab.png",
    logoName: "WIX",
    id: 15,
    link: "https://www.wix.com/",
    status: "Pending",
    cardType: "Visa",
    cardNumber: "*****1025",
    name: "Bob",
    date1: "Jan 28,2022",
    date1Compare: "2022/01/28",
    date2: "Aug 2,2022",
    date2Compare: "2022/08/02",
    email: "Itai Bracha31@gmail.com",
    transaction: 783.22,
    dot: "...",
  },

  {
    logo: "../img/5Tab.png",
    logoName: "Youtube",
    id: 16,
    link: "https://www.youtube.com/",
    cardType: "Visa",
    cardNumber: "*****8965",
    name: "Max",
    date1: "Jan 28,2022",
    date1Compare: "2022/01/28",
    date2: "Aug 10,2022",
    date2Compare: "2022/08/10",
    status: "Done",
    email: "Itai Bracha31@gmail.com",
    transaction: 783.22,
    dot: "...",
  },

  {
    logo: "../img/5Tab.png",
    logoName: "Youtube",
    id: 17,
    link: "https://www.youtube.com/",
    cardType: "Visa",
    cardNumber: "*****6892",
    name: "Pavlo",
    date1: "Jan 28,2022",
    date1Compare: "2022/01/28",
    date2: "Aug 2,2022",
    date2Compare: "2022/08/02",
    status: "Done",
    email: "Itai Bracha31@gmail.com",
    transaction: 783.22,
    dot: "...",
  },

  {
    logo: "../img/5Tab.png",
    logoName: "Youtube",
    id: 18,
    link: "https://www.youtube.com/",
    cardType: "Visa",
    cardNumber: "*****8963",
    name: "Sofi",
    date1: "Jan 28,2022",
    date1Compare: "2022/01/28",
    date2: "Aug 10,2022",
    date2Compare: "2022/08/10",
    status: "Done",
    email: "Itai Bracha31@gmail.com",
    transaction: 83.22,
    dot: "...",
  },
  {
    logo: "../img/1Tab.png",
    id: 19,
    logoName: "Figma",
    link: "https://www.figma.com/",
    cardType: "Visa",
    cardNumber: "*****1468",
    name: "Itai Bracha",
    date1: "Jan 10,2022",
    date1Compare: "2022/01/10",
    date2: "Aug 2,2022",
    date2Compare: "2022/08/02",
    status: "Done",
    email: "Itai Bracha31@gmail.com",
    transaction: 73.8,
    dot: "...",
  },
  {
    logo: "../img/2Tab.png",
    logoName: "Abode XD",
    id: 20,
    link: "https://www.adobe.com/",
    cardType: "Visa",
    cardNumber: "*****2122",
    name: "Anna",
    date1: "Jan 5,2022",
    date1Compare: "2022/01/05",
    date2: "Aug 10,2022",
    date2Compare: "2022/08/10",
    status: "Done",
    email: "Itai Bracha31@gmail.com",
    transaction: 883.9,
    dot: "...",
  },
  {
    logo: "../img/3Tab.png",
    logoName: "Mailchimp",
    id: 21,
    link: "https://mailchimp.com/",
    cardType: "Visa",
    cardNumber: "*****9632",
    name: "Kate",
    date1: "Jan 10,2022",
    date1Compare: "2022/01/10",
    date2: "Aug 2,2022",
    date2Compare: "2022/08/02",
    status: "Pending",
    email: "Itai Bracha31@gmail.com",
    transaction: 783.22,
    dot: "...",
  },

  {
    logo: "../img/4Tab.png",
    logoName: "WIX",
    id: 22,
    link: "https://www.wix.com/",
    status: "Pending",
    cardType: "Visa",
    cardNumber: "*****9876",
    name: "Bob",
    date1: "Jan 10,2022",
    date1Compare: "2022/01/10",
    date2: "Aug 10,2022",
    date2Compare: "2022/08/10",
    email: "Itai Bracha31@gmail.com",
    transaction: 77.22,
    dot: "...",
  },
];
let newMassive = [];

let dateStartMassive = "";
let dateEndMassive = "";
let dateStartMassive2 = "";
let dateEndMassive2 = "";

let currentPage = 1;
let rows = 5;
const tbodyDiv = document.getElementById("tbody");
const paginationElement = document.getElementById("pagination");
let searchInput = document.getElementById("search");
let searchInputByName = document.getElementById("searchByName");
let statusInput = document.getElementById("statusInput");
let date1 = document.getElementById("firstDate1");
let date2 = document.getElementById("lastDate2");

let buttonSorting1 = document.getElementById("buttonSorting1");
let buttonSorting2 = document.getElementById("buttonSorting2");

buttonSorting1.addEventListener("click", () => {
  buttonSorting1.classList.add("active");
  buttonSorting2.classList.remove("active");
  if (newMassive.length !== 0) {
    DisplayList(newMassive, tbodyDiv, rows, currentPage);
    document.getElementById("pagination").innerHTML = "";
    SetupPagination(newMassive, paginationElement, rows);
  } else {
    DisplayList(tableData, tbodyDiv, rows, currentPage);
    document.getElementById("pagination").innerHTML = "";
    SetupPagination(tableData, paginationElement, rows);
  }
});
buttonSorting2.addEventListener("click", () => {
  buttonSorting2.classList.add("active");
  buttonSorting1.classList.remove("active");
  if (newMassive.length !== 0) {
    DisplayList(newMassive, tbodyDiv, rows, currentPage);
    document.getElementById("pagination").innerHTML = "";
    SetupPagination(newMassive, paginationElement, rows);
  } else {
    DisplayList(tableData, tbodyDiv, rows, currentPage);
    document.getElementById("pagination").innerHTML = "";
    SetupPagination(tableData, paginationElement, rows);
  }
});

function DisplayList(items, wrapper, rowsPerPage, page) {
  wrapper.innerHTML = "";
  page--;

  if (buttonSorting1.classList.contains("active")) {
    items = items.sort((a, b) => {
      return a.transaction - b.transaction;
    });
  }
  if (buttonSorting2.classList.contains("active")) {
    items = items.sort((a, b) => {
      return b.transaction - a.transaction;
    });
  }

  let start = rowsPerPage * page;
  let end = start + rowsPerPage;
  let paginatedItems = items.slice(start, end);

  for (let i = 0; i < paginatedItems.length; i++) {
    let item = paginatedItems[i];
    let itemElement = document.createElement("tr");
    itemElement.classList.add("item");

    itemElement.innerHTML = ` 
    <td class='gapColumn'><input type="checkbox" name="checkbox-${item.id}"/></td>
    <td class="d-flex companyName">
    <img class="img_ro" src="${item.logo}" alt=${item.logoName} />
    <div>
      <div class='logo'>${item.logoName}</div>
      <div><a href="${item.link}">${item.logoName}</a></div>
    </div>
    <td class='cardsColumn'>
      <div>${item.cardType}</div>
      <div>${item.cardNumber}</div>
    </td>
    <td class='userName'>
      <div>${item.name}</div>
      <div>${item.email}</div>
    </td>
    <td class='lastTransactionColumn'>
      <div>${item.date1}</div>
      <div>$${item.transaction}</div>
    </td>
    <td class="status"><div class="${item.status.toLowerCase()}">${item.status}</div></td>
    <td class="date1">${item.date2}</td>
    <td id="totalMoney1" class="total">$ ${item.transaction}</td>
    <td class="menu"><div>${item.dot}</div></td>

`;
    wrapper.appendChild(itemElement);
  }
}

function PaginationButton(page) {
  let button = document.createElement("tr");
  button.innerText = page;
  if (currentPage == page) {
    button.classList.add("active");
  }

  button.addEventListener("click", function () {
    currentPage = page;
    DisplayList(newMassive, tbodyDiv, rows, currentPage);
    let currentBtn = document.querySelector(".pagenumbers tr.active");
    currentBtn.classList.remove("active");
    if (newMassive.length !== 0) {
      DisplayList(newMassive, tbodyDiv, rows, currentPage);
      document.getElementById("pagination").innerHTML = "";
      SetupPagination(newMassive, paginationElement, rows);
    } else {
      DisplayList(tableData, tbodyDiv, rows, currentPage);
      document.getElementById("pagination").innerHTML = "";
      SetupPagination(tableData, paginationElement, rows);
    }
  });

  return button;
}

function SetupPagination(items, wrapper, rowsPerPage) {
  wrapper.innerHtml = "";
  let buttonBack = document.createElement("tr");
  buttonBack.innerText = "<";
  buttonBack.addEventListener("click", () => {
    console.log("back");
    if (currentPage !== 1) {
      currentPage--;
      if (newMassive.length !== 0) {
        DisplayList(newMassive, tbodyDiv, rows, currentPage);
        document.getElementById("pagination").innerHTML = "";
        SetupPagination(newMassive, paginationElement, rows);
      } else {
        DisplayList(tableData, tbodyDiv, rows, currentPage);
        document.getElementById("pagination").innerHTML = "";
        SetupPagination(tableData, paginationElement, rows);
      }
    }
  });
  wrapper.appendChild(buttonBack);

  let pageCount = Math.ceil(items.length / rowsPerPage);
  for (let i = 1; i < pageCount + 1; i++) {
    let btn = PaginationButton(i);
    wrapper.appendChild(btn);
  }

  let buttonGo = document.createElement("tr");
  buttonGo.innerText = ">";
  buttonGo.addEventListener("click", () => {
    if (currentPage !== pageCount) {
      currentPage++;
      if (newMassive.length !== 0) {
        DisplayList(newMassive, tbodyDiv, rows, currentPage);
        document.getElementById("pagination").innerHTML = "";
        SetupPagination(newMassive, paginationElement, rows);
      } else {
        DisplayList(tableData, tbodyDiv, rows, currentPage);
        document.getElementById("pagination").innerHTML = "";
        SetupPagination(tableData, paginationElement, rows);
      }
    }
  });
  wrapper.appendChild(buttonGo);
}

DisplayList(tableData, tbodyDiv, rows, currentPage);
SetupPagination(tableData, paginationElement, rows);

function checkLogo(element) {
  if (searchInput.value.trim() !== "") {
    return element === searchInput.value.toLowerCase();
  } else {
    return true;
  }
}

function checkEmployee(element) {
  if (searchInputByName.value.trim() !== "") {
    return element === searchInputByName.value.toLowerCase();
  } else {
    return true;
  }
}

function checkStatusInput(element) {
  if (statusInput.value.trim() !== "") {
    return element === statusInput.value.toLowerCase();
  } else {
    return true;
  }
}

function checkDate1(element, start, end) {
  let current = element.date1Compare.split("/").map((item) => +item);
  let a = moment(start);
  let b = moment(current);
  let c = moment(end);
  if (date1.value.trim() !== "") {
    if (b.diff(a, "days") >= 0 && c.diff(b, "days") >= 0) {
      return true;
    } else {
      return false;
    }
  } else {
    return true;
  }
}
function checkDate2(element, start, end) {
  let current = element.date2Compare.split("/").map((item) => +item);
  let a = moment(start);
  let b = moment(current);
  let c = moment(end);
  if (date2.value.trim() !== "") {
    if (b.diff(a, "days") >= 0 && c.diff(b, "days") >= 0) {
      console.log("початкова і кінцева підходять");
      return true;
    } else {
      console.log("щось не підходить");
      return false;
    }
  } else {
    return true;
  }
}

searchInput.addEventListener("keyup", () => {
  newMassive = tableData.filter((elementOfMassive) => {
    return (
      checkLogo(elementOfMassive.logoName.toLowerCase()) &&
      checkEmployee(elementOfMassive.name.toLowerCase()) &&
      checkStatusInput(elementOfMassive.status.toLowerCase())
    );
  });

  if (newMassive.length !== 0) {
    paginationElement.innerHTML = "";
    DisplayList(newMassive, tbodyDiv, rows, currentPage);
    SetupPagination(newMassive, paginationElement, rows);
  }
});
searchInputByName.addEventListener("keyup", () => {
  newMassive = tableData.filter((elementOfMassive) => {
    return (
      checkLogo(elementOfMassive.logoName.toLowerCase()) &&
      checkEmployee(elementOfMassive.name.toLowerCase()) &&
      checkStatusInput(elementOfMassive.status.toLowerCase())
    );
  });
  console.log(newMassive);
  if (newMassive.length !== 0) {
    paginationElement.innerHTML = "";
    DisplayList(newMassive, tbodyDiv, rows, currentPage);
    SetupPagination(newMassive, paginationElement, rows);
  }
});
statusInput.addEventListener("keyup", () => {
  newMassive = tableData.filter((elementOfMassive) => {
    return (
      checkLogo(elementOfMassive.logoName.toLowerCase()) &&
      checkEmployee(elementOfMassive.name.toLowerCase()) &&
      checkStatusInput(elementOfMassive.status.toLowerCase())
    );
  });
  console.log(newMassive);
  if (newMassive.length !== 0) {
    paginationElement.innerHTML = "";
    DisplayList(newMassive, tbodyDiv, rows, currentPage);
    SetupPagination(newMassive, paginationElement, rows);
  }
});
$(function () {
  $('input[name="daterange"]').daterangepicker(
    {
      opens: "center",
    },
    function (start, end) {
      dateStartMassive = start
        .format("YYYY-MM-DD")
        .split("-")
        .map((item) => +item);
      dateEndMassive = end
        .format("YYYY-MM-DD")
        .split("-")
        .map((item) => +item);

      newMassive = newMassive.filter((elementOfMassive) => {
        return (
          checkLogo(elementOfMassive.logoName.toLowerCase()) &&
          checkEmployee(elementOfMassive.name.toLowerCase()) &&
          checkStatusInput(elementOfMassive.status.toLowerCase()) &&
          checkDate1(elementOfMassive, dateStartMassive, dateEndMassive)
        );
      });
      if (newMassive.length !== 0) {
        paginationElement.innerHTML = "";
        DisplayList(newMassive, tbodyDiv, rows, currentPage);
        SetupPagination(newMassive, paginationElement, rows);
      }
    }
  );
});
$(function () {
  $('input[name="daterange2"]').daterangepicker(
    {
      opens: "left",
    },
    function (start, end) {
      dateStartMassive2 = start
        .format("YYYY-MM-DD")
        .split("-")
        .map((item) => +item);
      dateEndMassive2 = end
        .format("YYYY-MM-DD")
        .split("-")
        .map((item) => +item);
      newMassive = newMassive.filter((elementOfMassive) => {
        return (
          checkLogo(elementOfMassive.logoName.toLowerCase()) &&
          checkEmployee(elementOfMassive.name.toLowerCase()) &&
          checkStatusInput(elementOfMassive.status.toLowerCase()) &&
          checkDate2(elementOfMassive, dateStartMassive2, dateEndMassive2)
        );
      });
      console.log(newMassive);
      if (newMassive.length !== 0) {
        paginationElement.innerHTML = "";
        DisplayList(newMassive, tbodyDiv, rows, currentPage);
        SetupPagination(newMassive, paginationElement, rows);
      }
    }
  );
});
